<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Page 3 | Rocking the world</title>
  <meta name="author" content="stephan">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Rocking the world"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.pn" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Rocking the world</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header">
  <h1>Rocking the world</h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">
      <i class="fa fa-heart"></i>
      Be Happy! Thank you yesterday!
</div>    
		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-19 </div>
			<div class="article-title"><a href="/2015/11/19/void-to-input-username-and-password-when-using-git/" >void to input username and password when using git</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>using git bash.<br>vim ~/.get-credentials<br><code>https://myusername:mypassword@git.oschina.net</code></p>
<p><code>git config credential.https://git.oschina.net.username myusername [--global]</code><br><code>git config credential.helper store --file=~/.git-credentials [--global]</code></p>
<p><code>git config credential.helper store</code></p>

	
	</div>
  <a type="button" href="/2015/11/19/void-to-input-username-and-password-when-using-git/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-19 </div>
			<div class="article-title"><a href="/2015/11/19/how-to-fix-file-is-open-in-another-program-on-windows/" >how to fix file is open in another program on windows</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>Why can’t I delete or move a file or folder?<br>What program is stopping me from deleting or moving a file or folder?<br>You really what to find the “Stupid guy” who is ocuppying the file?</p>
<p>Here you go! Boo.. There is an application called <code>Microsoft Process Explorer</code>.<br>Run it.<br>Go the menu bar of <code>Microsoft Process Explorer</code>.<br><code>Find</code> =&gt; <code>Here input the folder/file which you cannot delete.</code></p>
<p>It will show you which process ocupy it.</p>

	
	</div>
  <a type="button" href="/2015/11/19/how-to-fix-file-is-open-in-another-program-on-windows/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-18 </div>
			<div class="article-title"><a href="/2015/11/18/how-to-know-the-install-status-for-a-msi-installer/" >how to know the install status for a msi installer</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>Refer to <a href="http://stackoverflow.com/questions/320921/how-to-add-a-wix-custom-action-that-happens-only-on-uninstall-via-msi" target="_blank" rel="external">http://stackoverflow.com/questions/320921/how-to-add-a-wix-custom-action-that-happens-only-on-uninstall-via-msi</a></p>

	
	</div>
  <a type="button" href="/2015/11/18/how-to-know-the-install-status-for-a-msi-installer/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-12 </div>
			<div class="article-title"><a href="/2015/11/12/create-a-wcf-client-wrapper/" >Create a smart wcf client wrapper</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="A_good_start_for_wcf_client_programing-">A good start for wcf client programing.</h2><p>In the last article we presented a solution for calling WCF services that needed only a single line of code and no using statements.  But it had many limitations including</p>
<ul>
<li>Reliance on a static class</li>
<li>Testability was low for any code using it</li>
<li>Reliance on the WCF client rather than the contract</li>
<li>Not optimized for multiple calls<br>In reality the previous series of articles where all about setting up the infrastructure to support the final solution.  All this infrastructure will be hidden from code when we are done.  Let’s get started.</li>
</ul>
<h2 id="Service_Template">Service Template</h2><p>Ultimately we will be using T4 to generate service clients but the templates are complex and we do not yet even have an idea of what we’re building.  For this article we will build the final service client by hand.  In subsequent articles we will convert the code to a template.</p>
<p>The service client should meet the following goals</p>
<ul>
<li>Creatable using a standard new operator with no requirements for specifying any WCF endpoint information.</li>
<li>Implement the WCF contract interface so instances can be used as parameters such as in an IoC.</li>
<li>Instances do not need to be disposed.</li>
<li>Should allow multiple calls to be optimized through the same client.</li>
<li>Extensible to allow callers to adjust the client if needed.</li>
</ul>
<h2 id="ServiceChannelClient">ServiceChannelClient</h2><p>To start we will create a new abstract class that will serve as the base class for service clients.  While we could reuse the ServiceClientWrapper of previous articles that would expose too much WCF infrastructure.  Instead the class will wrap calls to <code>ServiceClientWrapper</code> and <code>ServiceClientFactory</code> from the previous articles.  All the functionality is protected since this is an abstract class.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public abstract class ServiceChannelClient&lt;TChannel&gt; where TChannel: class</span><br><span class="line">&#123;</span><br><span class="line">   protected virtual ServiceClientWrapper&lt;TChannel&gt; CreateInstance ()</span><br><span class="line">   &#123; return ServiceClientFactory.CreateAndWrap&lt;TChannel&gt;(); &#125;</span><br><span class="line"></span><br><span class="line">   protected virtual void InvokeMethod ( Action&lt;TChannel&gt; action )</span><br><span class="line">   &#123; ServiceClientFactory.InvokeMethod&lt;TChannel&gt;(action, CreateInstance); &#125;</span><br><span class="line"></span><br><span class="line">   protected virtual TResult InvokeMethod&lt;TResult&gt; ( Func&lt;TChannel, TResult&gt; action )</span><br><span class="line">   &#123; return ServiceClientFactory.InvokeMethod&lt;TChannel, TResult&gt;(action, CreateInstance); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Basically the class just wraps the classes from previous articles.  It is about to get more functionality but first let’s implement a WCF service client using the class.</p>
<h2 id="Typed_Service_Clients">Typed Service Clients</h2><p>Creating a class to wrap a WCF service is now pretty straightforward (depending upon the size of the interface).  We need only create a derived type and implement the interface using the methods provided in the base class.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class EmployeeServiceClient : ServiceChannelClient&lt;IEmployeeService&gt; , IEmployeeService</span><br><span class="line">&#123;</span><br><span class="line">   public Employee Get ( int id )</span><br><span class="line">   &#123; return InvokeMethod&lt;Employee&gt;(c =&gt; c.Get(id)); &#125;</span><br><span class="line"></span><br><span class="line">   public Employee Update ( Employee employee )</span><br><span class="line">   &#123; return InvokeMethod&lt;Employee&gt;(c =&gt; c.Update(employee)); &#125;  </span><br><span class="line"></span><br><span class="line">   public IEnumerable&lt;Employee&gt; GetEmployees ()</span><br><span class="line">   &#123; return InvokeMethod&lt;IEnumerable&lt;Employee&gt;&gt;(c =&gt; c.GetEmployees()); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>If we wanted we could make all the methods virtual to allow for extensibility.  We could also mark the type as partial to extend its abilities but the above code is sufficient until we move to T4.</p>
<p>Switching the application over to use the new client is straightforward.</p>
<ul>
<li>Remove the service reference code</li>
<li>Add the service interface assembly to the project</li>
<li>Replace all the existing calls with the new type<br>When the service reference code is removed it will remove the configuration entry for the service as well so that information will need to be put back in.  For now ensure the endpoint name matches the class name and that the contract name matches the namespace name of the interface.</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">!—-</span> <span class="attribute">Original</span> <span class="attribute">-</span>–&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">client</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="title">endpoint</span> <span class="attribute">address</span>=<span class="value">"http://localhost:21054/EmployeeService.svc"</span></span><br><span class="line">                 <span class="attribute">binding</span>=<span class="value">"basicHttpBinding"</span></span><br><span class="line">                 <span class="attribute">bindingConfiguration</span>=<span class="value">"BasicHttpBinding_IEmployeeService"</span></span><br><span class="line">                 <span class="attribute">contract</span>=<span class="value">"ServiceReference1.IEmployeeService"</span></span><br><span class="line">                 <span class="attribute">name</span>=<span class="value">"BasicHttpBinding_IEmployeeService"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">client</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">!—-</span> <span class="attribute">New</span> <span class="attribute">-</span>–&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">client</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">endpoint</span> <span class="attribute">address</span>=<span class="value">"http://localhost:21054/EmployeeService.svc"</span></span><br><span class="line">                 <span class="attribute">binding</span>=<span class="value">"basicHttpBinding"</span></span><br><span class="line">                 <span class="attribute">bindingConfiguration</span>=<span class="value">"BasicHttpBinding_IEmployeeService"</span></span><br><span class="line">                 <span class="attribute">contract</span>=<span class="value">"ServiceLib.IEmployeeService"</span></span><br><span class="line">                 <span class="attribute">name</span>=<span class="value">"EmployeeServiceClient"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">client</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The matching of the endpoint name with the client type name is only a convenience.  We can add a constructor that allows the endpoint name to be specified if we want.  Finally we can fix up the calls to the client.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Original</span></span><br><span class="line">ServiceClientFactory.InvokeMethod&lt;ServiceReference1.IEmployeeService&gt;(c =&gt;</span><br><span class="line">&#123;</span><br><span class="line">   dataGridView1.DataSource = c.GetEmployees();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//New</span></span><br><span class="line">dataGridView1.DataSource = Client.GetEmployees();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Poor man's injection</span></span><br><span class="line"><span class="keyword">private</span> IEmployeeService Client</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="keyword">return</span> m_client.Value; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> Lazy&lt;IEmployeeService&gt; m_client = <span class="keyword">new</span> Lazy&lt;IEmployeeService&gt;(() =&gt; <span class="keyword">new</span> EmployeeServiceClient());</span><br></pre></td></tr></table></figure>
<p>Now that we don’t need to dispose of objects or rely on static classes we can use just the interface which makes testing much easier.</p>
<h2 id="Multiple_Calls">Multiple Calls</h2><p>We’re almost done but we want to make one more change.  WCF service calls are not cheap so most calls tend to do several things at once rather than focusing on a single task like standard OOP would have you do.  But there are times when multiple calls are needed and the above code would require 2 client connections to be created.  Take, for example, this code in the sample application that creates 2 connections just to update an employee.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnNewEmployee</span> (<span class="params"> <span class="keyword">object</span> sender, EventArgs e </span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">   <span class="keyword">var</span> dlg = <span class="keyword">new</span> EmployeeForm();  </span><br><span class="line">   <span class="keyword">if</span> (dlg.ShowDialog(<span class="keyword">this</span>) != DialogResult.OK)</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//Call the service</span></span><br><span class="line">   Client.Update(dlg.Employee);</span><br><span class="line">   LoadEmployees();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LoadEmployees</span> (<span class="params"> </span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">   dataGridView1.DataSource = Client.GetEmployees();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>What we want to do is allow the client to tell us they plan to make multiple calls so we can optimize the client creation.  Since the client needs to be able to define the lifetime of the calls it makes sense to use a using statement.  All we need to do is provide a mechanism for creating a type that controls the lifetime of our client.  We can add this directly to the base client.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public abstract class ServiceChannelClient&lt;TChannel&gt; :</span><br><span class="line">     ISupportsPersistentChannel where TChannel: class</span><br><span class="line">&#123;</span><br><span class="line">   protected bool HasOpenChannel</span><br><span class="line">   &#123;</span><br><span class="line">      get &#123; return m_channel != null; &#125;</span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   protected virtual void CloseChannel ()</span><br><span class="line">   &#123;</span><br><span class="line">      var channel = Interlocked.Exchange(ref m_channel, null);</span><br><span class="line"></span><br><span class="line">      if (channel != null)  </span><br><span class="line">          channel.Close();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   protected virtual ServiceClientWrapper&lt;TChannel&gt; CreateInstance ()</span><br><span class="line">   &#123; return ServiceClientFactory.CreateAndWrap&lt;TChannel&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now the base class can have a temporary or permanent connection open depending upon the caller’s needs.  But how do we expose this to the caller?  Introducing the <code>ISupportsPersistentChannel</code> interface.  The sole purpose of this interface is to expose Open/Close methods.  Notice the methods are not exposed publicly but only through the interface.  This prevents callers from calling these methods accidentally.  Why is this important?  Why do we need an interface?  It’s all about interchangeability.</p>
<h2 id="Creating_A_Persistent_Channel">Creating A Persistent Channel</h2><p>Remember that one of the requirements is that we want to be able to use the service interface directly without regards to the implementation, including mocks.  Therefore persistence cannot require that we use the client class.  Instead we add an extension to the interface which gives us the ability to open a persisted channel irrelevant of the implementation.  The caller code will work the same whether we’re using our client type or a test mock.  Here’s the implementation.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeeServiceExtensions</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IDisposable <span class="title">OpenPersistentChannel</span> (<span class="params"> <span class="keyword">this</span> IEmployeeService source </span>)</span><br><span class="line">   </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> batch = source <span class="keyword">as</span> ISupportsPersistentChannel;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (batch != <span class="keyword">null</span>)</span><br><span class="line">      &#123;</span><br><span class="line">         batch.Open();  </span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">new</span> ActionDisposable(batch.Close);</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> Disposable.Empty;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The key is that the extension method will look for the <code>ISupportsPersistentChannel</code> interface.  For types deriving from <code>ServiceChannelClient</code> the interface will exist.  For other types it likely will not.  If the interface does exist then the channel is opened and an instance of a disposable class is returned that will close the channel.  Note the client itself is never returned.  If the interface does not exist then a disposable object is returned that does nothing.  This makes it safe for both production and test code.  Here’s how the caller would use it.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnNewEmployee</span> (<span class="params"> <span class="keyword">object</span> sender, EventArgs e </span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">   <span class="keyword">var</span> dlg = <span class="keyword">new</span> EmployeeForm();</span><br><span class="line">   <span class="keyword">if</span> (dlg.ShowDialog(<span class="keyword">this</span>) != DialogResult.OK)</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//Call the service</span></span><br><span class="line">   <span class="keyword">using</span> (<span class="keyword">var</span> proxy = Client.OpenPersistentChannel())   </span><br><span class="line">   &#123;</span><br><span class="line">      Client.Update(dlg.Employee);</span><br><span class="line">      LoadEmployees(Client);  </span><br><span class="line">   &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LoadEmployees</span> (<span class="params"> </span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">   LoadEmployees(Client);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LoadEmployees</span> (<span class="params"> IEmployeeService service </span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">   dataGridView1.DataSource = service.GetEmployees();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Next_Steps">Next Steps</h2><p>We are finally at the point where we have replaced the original service reference logic with a fully testable client that eliminates the dependency on WCF plumbing.  The resultant code is clean and can be mocked.  In the general case of single calls to WCF then the caller does not need to anything special.  For multiple calls the client (can) optimize performance with a <code>using</code> statement and it won’t break any test implementations.  The only issue remaining is the amount of code we’d need to generate for each WCF service.  The example client we created can be converted to a T4 template but it is going to require quite a bit of work.  However once we’re done we won’t have to revisit this code ever again.  We’ll pick up T4 next time.</p>
<p>Original from :<br><a href="http://blogs.msmvps.com/p3net/2014/03/15/a-smarter-wcf-service-client-part-4/" target="_blank" rel="external">http://blogs.msmvps.com/p3net/2014/03/15/a-smarter-wcf-service-client-part-4/</a><br><a href="http://blogs.msmvps.com/p3net/2014/05/18/a-smarter-wcf-service-client-part-5/" target="_blank" rel="external">http://blogs.msmvps.com/p3net/2014/05/18/a-smarter-wcf-service-client-part-5/</a></p>

	
	</div>
  <a type="button" href="/2015/11/12/create-a-wcf-client-wrapper/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-11 </div>
			<div class="article-title"><a href="/2015/11/11/wmi-query/" >WMI Query</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>The following WMI queries can be used as inspiration when working with driveres and other OS Deployment stuff…<br>IMPORTANT: If you copy/paste these queries, you might need to replace the quotes, as they often change format when you copy them from a website</p>

	
	</div>
  <a type="button" href="/2015/11/11/wmi-query/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-05 </div>
			<div class="article-title"><a href="/2015/11/05/upgrade-npm-on-windows/" >upgrade npm on windows</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>Powershell Run as Administrator<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Unrestricted -Scope CurrentUser -Force</span><br></pre></td></tr></table></figure></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g npm-windows-upgrade</span><br><span class="line">npm-windows-upgrade</span><br></pre></td></tr></table></figure>
<p>or Want to upgrade to specific version?</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm-windows-upgrade --version:<span class="number">3.1</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><a href="https://www.npmjs.com/package/npm-windows-upgrade" target="_blank" rel="external">Reference from npmjs.</a></p>

	
	</div>
  <a type="button" href="/2015/11/05/upgrade-npm-on-windows/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-05 </div>
			<div class="article-title"><a href="/2015/11/05/change-console-back-color-on-windows/" >How to change console back color on windows?</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="Samples">Samples</h2><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">@rem Is black and white</span></span><br><span class="line"><span class="built_in">Color</span> <span class="number">0</span>F</span><br></pre></td></tr></table></figure>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">@rem Is black and green</span></span><br><span class="line"><span class="built_in">Color</span> <span class="number">0</span>A</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2015/11/05/change-console-back-color-on-windows/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-10-30 </div>
			<div class="article-title"><a href="/2015/10/30/git-tips-for-daily-work/" >git-tips-for-daily-work</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="Realize_you_forgot_to_add_the_changes_from_xxx-ext">Realize you forgot to add the changes from xxx.ext</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add xxx.ext&#10;git commit --amend --no-edit</span><br></pre></td></tr></table></figure>
<h2 id="The_difference_between_git_reset_and_git_revert">The difference between git reset and git revert</h2><p>git revert 是撤销某次操作，此次操作之前的commit都会被保留<br>git reset 是撤销某次提交，但是此次之后的修改都会被退回到暂存区<br>具体一个例子，假设有三个commit， git st:<br>commit3: add test3.c<br>commit2: add test2.c<br>commit1: add test1.c<br>当执行git revert HEAD~1时， commit2被撤销了<br>git log可以看到：<br>commit1：add test1.c<br>commit3：add test3.c<br>git status 没有任何变化<br>如果换做执行git reset –soft(默认) HEAD~1后，运行git log<br>commit2: add test2.c<br>commit1: add test1.c<br>运行git status， 则test3.c处于暂存区，准备提交。<br>如果换做执行git reset –hard HEAD~1后，<br>显示：HEAD is now at commit2，运行git log<br>commit2: add test2.c<br>commit1: add test1.c<br>运行git st， 没有任何变化<br>另外：<br>git revert <commit log="" string="">是撤消该commit，作为一个新的commit。</commit></p>
<h2 id="Change_bash_indicator-">Change bash indicator.</h2><p>go to git install dir.<br>ex: C:\Program Files\Git\etc<br>open bash.bashrc<br>find PS1 section.<br>it should be something like<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set a default prompt of: user@host, MSYSTEM variable, and current_directory</span></span><br><span class="line"><span class="comment">#PS1='\[\e]0;\w\a\]\n\[\e[32m\]\u@\h \[\e[35m\]$MSYSTEM\[\e[0m\] \[\e[33m\]\w\[\e[0m\]\n \e[33m\]&gt;&gt;\e[0m\] '</span></span><br></pre></td></tr></table></figure></p>
<h2 id="force_push_(will_sync_remote_by_local)">force push (will sync remote by local)</h2><p>helps if you push something by mistake.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master:master `--force`</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2015/10/30/git-tips-for-daily-work/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-10-30 </div>
			<div class="article-title"><a href="/2015/10/30/reading/" >Keep learning</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<blockquote><p>“Optimising your notation to not confuse people in the first 10 minutes of seeing it but to hinder readability ever after is a really bad mistake.”</p>
<footer><strong>David MacIver - </strong><cite><a href="http://rickyclarkson.blogspot.co.uk/2008/01/in-defence-of-0l-in-scala.html" target="_blank" rel="external">a post about Scala syntax</a></cite></footer></blockquote>

	
	</div>
  <a type="button" href="/2015/10/30/reading/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-10-27 </div>
			<div class="article-title"><a href="/2015/10/27/share-source-file-in-net/" >Share source file in .Net</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<figure class="highlight"><figcaption><span>#</span><a href="http://stackoverflow.com/questions/1116465/how-do-you-share-code-between-projects-solutions-in-visual-studio" target="_blank" rel="external">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Compile Include="..\MySisterProject\**\*.cs"&gt;</span><br><span class="line">  &lt;Link&gt;_Inlined\MySisterProject\%(RecursiveDir)%(Filename)%(Extension)&lt;/Link&gt;</span><br><span class="line">  &lt;Visible&gt;false&lt;/Visible&gt;</span><br><span class="line">&lt;/Compile&gt;</span><br></pre></td></tr></table></figure>
<h2 id="linq_samples">linq samples</h2><p><a href="http://blog.csdn.net/smartsmile2012/article/details/44873251" target="_blank" rel="external">101 linq sample</a></p>

	
	</div>
  <a type="button" href="/2015/10/27/share-source-file-in-net/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
		
    	<li class="prev"><a href="/page/2/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i> Prev</a></li>
  		

        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>

		
		   <li class="next"> <a href="/page/4/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a> </li>          
        
	
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/reading/backlog/">backlog<span>1</span></a></li>
		
			<li><a href="/categories/coding/">coding<span>23</span></a></li>
		
			<li><a href="/categories/life/">life<span>2</span></a></li>
		
			<li><a href="/categories/programing/">programing<span>1</span></a></li>
		
			<li><a href="/categories/reading/">reading<span>2</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/asp-net/">asp.net<span>2</span></a></li>
		
			<li><a href="/tags/exception/">exception<span>1</span></a></li>
		
			<li><a href="/tags/svn/">svn<span>1</span></a></li>
		
			<li><a href="/tags/msi/">msi<span>1</span></a></li>
		
			<li><a href="/tags/stuff/">stuff<span>2</span></a></li>
		
			<li><a href="/tags/dailywork/">dailywork<span>6</span></a></li>
		
			<li><a href="/tags/php/">php<span>1</span></a></li>
		
			<li><a href="/tags/npm/">npm<span>1</span></a></li>
		
			<li><a href="/tags/net/">.net<span>6</span></a></li>
		
			<li><a href="/tags/c/">c#<span>1</span></a></li>
		
			<li><a href="/tags/java/">java<span>2</span></a></li>
		
			<li><a href="/tags/nodejs/">nodejs<span>3</span></a></li>
		
			<li><a href="/tags/web/">web<span>1</span></a></li>
		
			<li><a href="/tags/mac/">mac<span>1</span></a></li>
		
			<li><a href="/tags/ohters/">ohters<span>1</span></a></li>
		
			<li><a href="/tags/javascript/">javascript<span>1</span></a></li>
		
			<li><a href="/tags/windows/">windows<span>8</span></a></li>
		
			<li><a href="/tags/wmi/">wmi<span>1</span></a></li>
		
			<li><a href="/tags/tips/">tips<span>13</span></a></li>
		
			<li><a href="/tags/words/">words<span>2</span></a></li>
		
		
		   <li><a href="/tags">...<span>28</span></a></li>
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2016/04/06/using-git-svn-together/" ><i class="fa fa-file-o"></i>using git svn together...</a>
      </li>
    
      <li>
        <a href="/2016/04/06/side-by-side/" ><i class="fa fa-file-o"></i>...</a>
      </li>
    
      <li>
        <a href="/2016/03/29/play-with-elgg/" ><i class="fa fa-file-o"></i>play with elgg...</a>
      </li>
    
      <li>
        <a href="/2016/02/26/my-backlog/" ><i class="fa fa-file-o"></i>my backlog...</a>
      </li>
    
      <li>
        <a href="/2016/02/21/a-better-way-to-secure-your-wcf-services/" ><i class="fa fa-file-o"></i>a better way to secure your...</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/catwarrior/catwarrior.github.io" title="Catwarrior's Github repository." target="_blank"]);">Catwarrior</a></li>
	
		<li><i class="fa fa-github"></i><a href="https://github.com/catwarrior" title="My Github account." target="_blank"]);">My Github</a></li>
	
		<li><i class="fa fa-linkedin"></i><a href="http://www.linkedin.com/in/stephan" title="My Linkin account." target="_blank"]);">My LinkedIn</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2016 stephan
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
